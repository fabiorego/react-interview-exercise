<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <title>Home</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />

    <!-- Custom styles -->
    <link href="base.css" rel="stylesheet" />
    <link href="home.css" rel="stylesheet" />
</head>

<body>
    <header>
        <nav class="navbar navbar-dark bg-dark shadow-sm fixed-top">
            <a class="navbar-brand" href="#">
                <img src="https://picsum.photos/30" width="30" height="30" class="d-inline-block align-top" alt="">
                React@Celfocus
            </a>
            <ul class="navbar">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Repos <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Users</a>
                </li>
            </ul>
        </nav>
    </header>

    <main role="main">
        <section class="jumbotron text-center">
            <div class="container">
                <div class="alert alert-success" role="alert">
                    Template for success message
                </div>
                <div class="alert alert-danger" role="alert">
                    Template for error message
                </div>
                <div class="alert alert-warning" role="alert">
                    Template for warning message
                </div>
                <div class="alert alert-info" role="alert">
                    Template for alert message
                </div>

                <h1>Search GitHub Repos</h1>
                <p class="lead text-muted">Search for GitHub repos using the following form</p>
                <form id="search-form" class="form-inline justify-content-center">
                    <label for="inputSearch" class="sr-only">Search by</label>
                    <input type="text" id="inputSearch" class="form-control" placeholder="Search Repo" required
                        autofocus />
                    <button class="btn btn-primary" type="submit">Search</button>
                    <button class="btn btn-secondary" type="reset">Clear</button>
                </form>
            </div>
        </section>

        <div class="album py-5 bg-light">
            <div class="container">
                <div id="repos-list" class="row">

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repo Card Template -->
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm h-100">
                            <img src="https://picsum.photos/300/225" alt="repo owner avatar" width="100%"
                                height="225" />
                            <div class="card-body">
                                <p class="card-text">
                                    This is a wider card with supporting text below as a natural lead-in to
                                    additional content. This content is a little bit longer.
                                </p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3"></div>
                    <div class="col-md-2">
                        <select class="custom-select">
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="15">15</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <ul class="pagination">
                            <li class="page-item"><button class="page-link">Previous</button></li>
                            <li class="page-item"><button class="page-link">1</a></li>
                            <li class="page-item"><button class="page-link">2</button></li>
                            <li class="page-item"><button class="page-link">3</button></li>
                            <li class="page-item"><button class="page-link">Next</button></li>
                        </ul>
                    </div>
                    <div class="col-md-3"></div>
                </div>
            </div>
    </main>

    <footer class="text-muted">
        <div class="container">
            <p class="float-right">
                <a href="#">Back to top</a>
            </p>
            <p>This catalog is an example using bootstrap design system!</p>
        </div>
    </footer>

    <div id="confirm-modal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirm</h5>
                    <button type="button" class="close" aria-label="Close">
                        <span aria-hidden="true">x</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Do you confirm staring repo</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary">Close</button>
                    <button type="button" class="btn btn-primary">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <div id="view-modal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">$USER NAME</h5>
                    <button type="button" class="close" aria-label="Close">
                        <span aria-hidden="true">x</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="https://picsum.photos/300/225" alt="Repo owner avatar" width="100%" height="225" />
                    <p>DESCRIPTION HERE</p>
                    <a href="#">GO TO REPO</a>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading-container">
        <div class="d-flex justify-content-center align-items-center loader">
            <div class="spinner-border text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
    </div>

    <script>
        // Just an example for templating. Not the React Way. This is not the way supposed for the exercise.
        const showLoading = function showLoading() {
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
        };

        const hideLoading = function hideLoading() {
            const loading = document.getElementById('loading');
            loading.style.display = 'none';
        };

        const openConfirmModal = function openConfirmModal() {
            const confirmModal = document.getElementById('confirm-modal');
            confirmModal.style.display = 'block';
        };

        const closeConfirmModal = function openConfirmModal() {
            const confirmModal = document.getElementById('confirm-modal');
            confirmModal.style.display = 'none';
        };

        const openViewModal = function openViewModal() {
            const viewModal = document.getElementById('view-modal');
            viewModal.style.display = 'block';
        };

        const closeViewModal = function closeViewModal() {
            const viewModal = document.getElementById('view-modal');
            viewModal.style.display = 'none';
        };

        const htmlForRepo = function htmlForRepo(repo) {
            return `<div class="col-md-4 mb-4">
              <div class="card shadow-sm h-100">
                <img
                  src="${repo.owner.avatar_url}"
                  alt="repo owner avatar"
                  width="100%"
                  height="225"
                />
                <div class="card-body">
                  <p class="card-text">${repo.description}</p>
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                      <button type="button" class="btn btn-sm btn-outline-secondary">View</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary">Star</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>`;
        }

        /* Just an example */
        const fetchRepos = async function fetchRepos(query) {
            showLoading();

            try {
                const fetchResponse = await fetch(`https://api.github.com/search/repositories?q=${query}&page=1&per_page=9`);
                const jsonResponse = await fetchResponse.json();

                const repos = jsonResponse.items;
                let reposListHtml = '';

                const handleRepo = function handleRepo(repo) {
                    const repoHtml = htmlForRepo(repo);
                    reposListHtml += repoHtml;
                };

                /* Declarative way */
                repos.forEach(handleRepo);

                /* Imperative way */
                /* Example to make a point
                for (let i = 0; i < repos.length; i++) {
                    const repo = repos[i];
    
                    const repoHtml = htmlForRepo(repo);
                    reposListHtml += repoHtml;   
    
                }
                */

                const reposList = document.getElementById('repos-list');
                reposList.innerHTML = reposListHtml;
            } catch (error) {
                // TODO handle error
                console.log('Error: ', error);
            };

            hideLoading();
        }

        const searchFormSubmit = function searchFormSubmit(event) {
            event.preventDefault();

            const inputSearch = document.getElementById('inputSearch');
            fetchRepos(inputSearch.value);
        }

        // Just for example purpose - using bubbling technique
        const handleButtonClicks = function handleButtonClicks(event) {
            // comparing by text -- do not do it
            if (event.target.textContent === 'Star') {
                openConfirmModal();
            } else if (event.target.textContent === 'View') {
                openViewModal();
            } else if (event.target.textContent === 'Close') {
                closeConfirmModal();
                closeViewModal();
            } else if (event.target.textContent === 'Confirm') {
                console.log('Following User');
                closeConfirmModal();
            } else if (event.target.textContent === 'x') {
                closeConfirmModal();
                closeViewModal();
            }
        };

        hideLoading();

        document.body.addEventListener('click', handleButtonClicks);

        const searchForm = document.getElementById('search-form');
        searchForm.addEventListener('submit', searchFormSubmit);
    </script>
</body>

</html>